<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AiGentsy — AI-Powered Services Catalog</title>

  <!-- Open Graph -->
  <meta property="og:title" content="AiGentsy — AI-Powered Services" />
  <meta property="og:description" content="Professional work delivered by autonomous AI teams — faster and more affordable than traditional agencies." />
  <meta property="og:image" content="/aigentsy-logo-ultraclean.png" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://aigentsy.com/catalog" />
  <meta name="description" content="Browse AiGentsy's full catalog of AI-powered services. Professional deliverables at a fraction of agency pricing, completed in hours not weeks." />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', sans-serif;
      background: radial-gradient(circle at center, #0e101a, #000);
      color: #fff;
      min-height: 100vh;
    }

    /* ── Fade-in animation ── */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(18px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fadeIn 0.7s ease-out both; }

    /* ── Header / Hero ── */
    .page-header {
      text-align: center;
      padding: 48px 24px 32px;
      animation: fadeIn 0.6s ease-out both;
    }
    .page-header img {
      width: 140px;
      margin-bottom: 20px;
    }
    .page-header h1 {
      font-size: 2.4rem;
      font-weight: 700;
      color: #fff;
      margin-bottom: 12px;
    }
    .page-header h1 span {
      color: #00bfff;
    }
    .page-header p {
      color: #999;
      font-size: 1.05rem;
      max-width: 640px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* ── Search / Filter ── */
    .search-wrap {
      max-width: 480px;
      margin: 28px auto 0;
      position: relative;
      animation: fadeIn 0.7s ease-out 0.15s both;
    }
    .search-wrap input {
      width: 100%;
      padding: 14px 18px 14px 44px;
      border-radius: 10px;
      border: 1px solid #333;
      background: #111;
      color: #fff;
      font-size: 0.95rem;
      font-family: inherit;
      outline: none;
      transition: border-color 0.2s;
    }
    .search-wrap input::placeholder { color: #555; }
    .search-wrap input:focus { border-color: #00bfff; }
    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #555;
      pointer-events: none;
      font-size: 1rem;
    }

    /* ── Count badge ── */
    .count-badge {
      text-align: center;
      color: #666;
      font-size: 0.85rem;
      margin-top: 14px;
      animation: fadeIn 0.7s ease-out 0.25s both;
    }

    /* ── Grid ── */
    .catalog-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      max-width: 1200px;
      margin: 32px auto 60px;
      padding: 0 24px;
    }

    /* ── Card ── */
    .service-card {
      background: #111;
      border: 1px solid #222;
      border-radius: 12px;
      padding: 24px;
      display: flex;
      flex-direction: column;
      transition: border-color 0.25s, transform 0.25s;
    }
    .service-card:hover {
      border-color: #00bfff44;
      transform: translateY(-4px);
    }
    .service-card h3 {
      color: #00bfff;
      font-size: 1.15rem;
      font-weight: 600;
      margin-bottom: 14px;
    }

    /* price row */
    .price-row {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    .price-market {
      text-decoration: line-through;
      color: #888;
      font-size: 1rem;
    }
    .price-ai {
      color: #00ff88;
      font-weight: 700;
      font-size: 1.2rem;
    }

    /* savings pill */
    .savings-pill {
      display: inline-block;
      background: rgba(0,255,136,0.1);
      color: #00ff88;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.78rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    /* delivery */
    .delivery-time {
      color: #aaa;
      font-size: 0.88rem;
      margin-bottom: 14px;
    }

    /* deliverables */
    .deliverables {
      list-style: disc;
      padding-left: 18px;
      margin-bottom: 20px;
      flex: 1;
    }
    .deliverables li {
      color: #ccc;
      font-size: 0.85rem;
      margin-bottom: 5px;
      line-height: 1.4;
    }

    /* CTA button */
    .card-cta {
      display: block;
      width: 100%;
      text-align: center;
      padding: 12px 0;
      border-radius: 8px;
      border: none;
      background: linear-gradient(135deg, #00bfff, #0099cc);
      color: #fff;
      font-weight: 600;
      font-size: 0.95rem;
      font-family: inherit;
      cursor: pointer;
      text-decoration: none;
      transition: opacity 0.2s;
    }
    .card-cta:hover { opacity: 0.85; }

    /* ── Loading state ── */
    .loading-state {
      text-align: center;
      padding: 80px 24px;
      animation: fadeIn 0.5s ease-out both;
    }
    .spinner {
      width: 36px;
      height: 36px;
      border: 3px solid #222;
      border-top-color: #00bfff;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 16px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    .loading-state p { color: #666; font-size: 0.95rem; }

    /* ── Error state ── */
    .error-state {
      text-align: center;
      padding: 80px 24px;
      color: #ff6b6b;
    }
    .error-state p { margin-bottom: 16px; }
    .retry-btn {
      padding: 10px 24px;
      border-radius: 8px;
      border: 1px solid #ff6b6b;
      background: transparent;
      color: #ff6b6b;
      font-family: inherit;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background 0.2s;
    }
    .retry-btn:hover { background: rgba(255,107,107,0.1); }

    /* ── Empty filter ── */
    .no-results {
      grid-column: 1 / -1;
      text-align: center;
      padding: 48px 24px;
      color: #666;
      font-size: 0.95rem;
    }

    /* ── Footer ── */
    .page-footer {
      text-align: center;
      padding: 32px 24px 40px;
      color: #444;
      font-size: 0.8rem;
      border-top: 1px solid #1a1a1a;
    }
    .page-footer a { color: #00bfff; text-decoration: none; }
    .page-footer a:hover { text-decoration: underline; }

    /* ── Responsive ── */
    @media (max-width: 600px) {
      .page-header h1 { font-size: 1.7rem; }
      .page-header p { font-size: 0.92rem; }
      .catalog-grid { gap: 16px; padding: 0 16px; }
      .service-card { padding: 20px; }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="page-header">
    <a href="/"><img src="/aigentsy-logo-ultraclean.png" alt="AiGentsy" /></a>
    <h1>AI-Powered <span>Services</span></h1>
    <p>Professional work delivered by autonomous AI teams &mdash; faster and more affordable than traditional agencies</p>

    <div class="search-wrap">
      <span class="search-icon">&#128269;</span>
      <input type="text" id="searchInput" placeholder="Search services..." autocomplete="off" />
    </div>
    <div class="count-badge" id="countBadge"></div>
  </header>

  <!-- Content area -->
  <main>
    <div id="loadingState" class="loading-state">
      <div class="spinner"></div>
      <p>Loading service catalog...</p>
    </div>

    <div id="errorState" class="error-state" style="display:none;">
      <p id="errorMsg">Failed to load catalog.</p>
      <button class="retry-btn" onclick="fetchCatalog()">Retry</button>
    </div>

    <div id="catalogGrid" class="catalog-grid" style="display:none;"></div>
  </main>

  <!-- Footer -->
  <footer class="page-footer">
    <p>&copy; 2026 <a href="/">AiGentsy</a> &mdash; Autonomous AI workforce</p>
  </footer>

  <script>
    const API_BASE = 'https://aigentsy-ame-runtime.onrender.com';

    // Grab ?ref= from current page URL
    const urlParams  = new URLSearchParams(window.location.search);
    const refParam   = urlParams.get('ref') || '';

    let allServices = [];

    // ── Format currency ──
    function fmt(n) {
      return '$' + Number(n).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
    }

    // ── Build intake link ──
    function intakeLink(serviceId) {
      let url = '/intake?sku=' + encodeURIComponent(serviceId) + '&ref=catalog';
      if (refParam) url += '&source_ref=' + encodeURIComponent(refParam);
      return url;
    }

    // ── Render a single card ──
    function renderCard(svc, index) {
      const card = document.createElement('div');
      card.className = 'service-card fade-in';
      card.style.animationDelay = (index * 0.06) + 's';
      card.dataset.name = svc.name.toLowerCase();

      let deliverablesHTML = '';
      if (svc.deliverables && svc.deliverables.length) {
        deliverablesHTML = '<ul class="deliverables">' +
          svc.deliverables.map(d => '<li>' + escapeHTML(d) + '</li>').join('') +
          '</ul>';
      }

      card.innerHTML =
        '<h3>' + escapeHTML(svc.name) + '</h3>' +
        '<div class="price-row">' +
          '<span class="price-market">' + fmt(svc.market_price) + '</span>' +
          '<span class="price-ai">' + fmt(svc.ai_price_standard) + '</span>' +
        '</div>' +
        '<span class="savings-pill">' + svc.savings_percent + '% savings</span>' +
        '<div class="delivery-time">Delivered in ~' + svc.ai_time_hours + 'h</div>' +
        deliverablesHTML +
        '<a class="card-cta" href="' + intakeLink(svc.id) + '">Start This Project</a>';

      return card;
    }

    // ── Escape HTML ──
    function escapeHTML(str) {
      const d = document.createElement('div');
      d.textContent = str;
      return d.innerHTML;
    }

    // ── Render grid ──
    function renderGrid(services) {
      const grid = document.getElementById('catalogGrid');
      grid.innerHTML = '';

      if (services.length === 0) {
        grid.innerHTML = '<div class="no-results">No services match your search.</div>';
        document.getElementById('countBadge').textContent = '0 services';
        return;
      }

      services.forEach((svc, i) => grid.appendChild(renderCard(svc, i)));
      document.getElementById('countBadge').textContent = services.length + ' service' + (services.length !== 1 ? 's' : '') + ' available';
    }

    // ── Filter handler ──
    document.getElementById('searchInput').addEventListener('input', function () {
      const q = this.value.toLowerCase().trim();
      if (!q) { renderGrid(allServices); return; }
      const filtered = allServices.filter(s => s.name.toLowerCase().includes(q));
      renderGrid(filtered);
    });

    // ── Fetch catalog ──
    async function fetchCatalog() {
      const loadEl  = document.getElementById('loadingState');
      const errEl   = document.getElementById('errorState');
      const gridEl  = document.getElementById('catalogGrid');

      loadEl.style.display  = 'block';
      errEl.style.display   = 'none';
      gridEl.style.display  = 'none';

      try {
        const res  = await fetch(API_BASE + '/services/catalog');
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const data = await res.json();
        if (!data.ok) throw new Error(data.error || 'API returned ok=false');

        allServices = data.services || [];

        loadEl.style.display = 'none';
        gridEl.style.display = 'grid';
        renderGrid(allServices);
      } catch (err) {
        loadEl.style.display = 'none';
        errEl.style.display  = 'block';
        document.getElementById('errorMsg').textContent = 'Failed to load catalog: ' + err.message;
      }
    }

    // ── Init ──
    fetchCatalog();
  </script>
</body>
</html>
