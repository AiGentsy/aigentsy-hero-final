<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>AiGentsy ‚Äî Launch Your AI Business Empire Now</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: radial-gradient(circle at center, #101c2c, #000000);
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
      overflow-y: auto;
      position: relative;
    }
    
    .bg-animation {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 0;
      background: radial-gradient(circle at 50% 50%, #ffffff11, transparent 60%);
      animation: bgPulse 6s ease-in-out infinite;
      pointer-events: none;
    }
    
    .hero {
      position: relative;
      z-index: 2;
      max-width: 1000px;
      margin: 0 auto;
      padding: 60px 20px 80px;
      animation: fadeIn 1.5s ease-out;
    }
    
    .logo {
      display: block;
      margin: 0 auto 30px;
      max-width: 240px;
    }
    
    .hero h1 {
      font-size: 3.2rem;
      color: #fff;
      margin-bottom: 20px;
      font-weight: 700;
      line-height: 1.2;
      text-shadow: 0 0 20px rgba(0,191,255,0.3);
      text-align: center;
    }
    
    .hero .subheadline {
      font-size: 1.3rem;
      color: #00bfff;
      margin-bottom: 15px;
      font-weight: 600;
      text-align: center;
    }
    
    .hero p {
      font-size: 1.15rem;
      color: #ccc;
      margin-bottom: 30px;
      line-height: 1.6;
      text-align: center;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    
    /* SEARCH BAR STYLES */
    .search-section {
      max-width: 700px;
      margin: 40px auto;
      position: relative;
    }
    
    .search-label {
      font-size: 1.1rem;
      color: #fff;
      margin-bottom: 12px;
      font-weight: 600;
      display: block;
      text-align: center;
    }
    
    .search-wrapper {
      position: relative;
      width: 100%;
    }
    
    .search-input {
      width: 100%;
      padding: 16px 50px 16px 20px;
      font-size: 1.1rem;
      border: 2px solid #00bfff;
      border-radius: 50px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      outline: none;
      transition: all 0.3s ease;
      box-shadow: 0 0 20px rgba(0,191,255,0.2);
    }
    
    .search-input:focus {
      border-color: #00ffcc;
      box-shadow: 0 0 30px rgba(0,255,204,0.4);
      background: rgba(0,0,0,0.8);
    }
    
    .search-input::placeholder {
      color: #888;
    }
    
    .search-icon {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.4rem;
      color: #00bfff;
      pointer-events: none;
    }
    
    .search-results {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: #111;
      border: 2px solid #00bfff;
      border-radius: 16px;
      margin-top: 8px;
      max-height: 300px;
      overflow-y: auto;
      display: none;
      box-shadow: 0 10px 40px rgba(0,0,0,0.8);
      z-index: 1000;
    }
    
    .search-results.active {
      display: block;
    }
    
    .search-result-item {
      padding: 14px 20px;
      cursor: pointer;
      transition: all 0.2s ease;
      border-bottom: 1px solid #222;
      text-align: left;
    }
    
    .search-result-item:last-child {
      border-bottom: none;
    }
    
    .search-result-item:hover {
      background: #1a1a1a;
      padding-left: 24px;
    }
    
    .search-result-title {
      font-size: 1rem;
      font-weight: 600;
      color: #00bfff;
      margin-bottom: 4px;
    }
    
    .search-result-desc {
      font-size: 0.85rem;
      color: #aaa;
    }
    
    .search-suggestion {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #00bfff;
      font-style: italic;
      min-height: 20px;
      text-align: center;
    }
    
    .social-proof {
      font-size: 0.95rem;
      color: #888;
      margin: 30px auto 40px;
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .social-proof span {
      background: #111;
      padding: 8px 16px;
      border-radius: 20px;
      border: 1px solid #333;
    }
    
    .consent-box {
      background: rgba(13,13,13,0.95);
      border: 1px solid rgba(255,255,255,0.3);
      padding: 32px;
      border-radius: 16px;
      max-width: 700px;
      margin: 0 auto;
      box-shadow: 0 0 30px rgba(0,0,0,0.5);
    }
    
    .consent-box input[type="text"],
    .consent-box input[type="password"] {
      width: 100%;
      padding: 14px 16px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ffffff;
      background: #111;
      color: #fff;
      font-size: 1rem;
    }
    
    .consent-box label {
      display: block;
      margin: 16px 0;
      font-size: 0.95rem;
      color: #ccc;
      text-align: center;
    }
    
    .toggle-auth {
      margin: 12px 0;
      color: #00bfff;
      cursor: pointer;
      font-size: 0.95rem;
      text-decoration: underline;
      text-align: center;
    }
    
    .consent-box button {
      margin-top: 24px;
      padding: 16px 32px;
      background: linear-gradient(135deg, #00bfff, #0080ff);
      color: #fff;
      font-weight: bold;
      font-size: 1.15rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .consent-box button:hover:not(:disabled) {
      transform: scale(1.02);
      box-shadow: 0 0 20px #00bfff;
    }
    
    .consent-box button:disabled {
      background: #444;
      cursor: not-allowed;
      opacity: 0.6;
    }
    
    .section-title {
      color: #00bfff;
      margin: 30px 0 16px;
      font-size: 1.15rem;
      font-weight: 600;
      text-align: center;
    }
    
    .aigent-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 14px;
      margin-top: 20px;
    }
    
    @media (max-width: 700px) {
      .aigent-options { 
        grid-template-columns: 1fr; 
      }
      .hero h1 { 
        font-size: 2.2rem; 
      }
      .hero {
        padding: 40px 16px 60px;
      }
      .consent-box {
        padding: 24px;
      }
    }
    
    .aigent-card {
      background: linear-gradient(135deg, #111 0%, #1a1a1a 100%);
      border: 2px solid #333;
      color: #fff;
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      position: relative;
      overflow: hidden;
    }
    
    .aigent-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent, rgba(0,191,255,0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .aigent-card.selected::before,
    .aigent-card:hover::before {
      opacity: 1;
    }
    
    .aigent-card.selected,
    .aigent-card:hover {
      border-color: #00bfff;
      box-shadow: 0 0 20px rgba(0,191,255,0.4);
      transform: translateY(-2px);
    }
    
    .aigent-card-title {
      font-size: 1.15rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: #00bfff;
    }
    
    .aigent-card-desc {
      font-size: 0.9rem;
      color: #aaa;
      line-height: 1.5;
    }
    
    .aigent-card-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #00bfff;
      color: #000;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 700;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .aigent-card.selected .aigent-card-badge {
      opacity: 1;
    }
    
    .footer-note {
      margin-top: 60px;
      padding-bottom: 40px;
      font-size: 0.95rem;
      color: #666;
      letter-spacing: 0.5px;
      text-align: center;
    }
    
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes bgPulse {
      0%, 100% { transform: scale(1); opacity: 0.5; }
      50% { transform: scale(1.08); opacity: 0.7; }
    }
  </style>
</head>
<body>
  <div class="bg-animation"></div>
  
  <div class="hero">
    <img src="aigentsy-logo-ultraclean.png" alt="AiGentsy Logo" class="logo" />
    
    <h1>Launch Your AI Business Empire Now</h1>
    
    <p class="subheadline">Your Business, Powered by Autonomous AI ‚Äî Revenue Starts Today</p>
    
    <p>Build a fully-staffed AI company with a C-Suite team that finds clients, closes deals, and scales itself ‚Äî while you sleep.</p>
    
    <!-- SEARCH BAR FOR WHITELABEL BUSINESSES -->
    <div class="search-section">
      <label class="search-label">üîç Search for Your Perfect AI Business:</label>
      <div class="search-wrapper">
        <input 
          type="text" 
          id="businessSearch" 
          class="search-input" 
          placeholder="Try: legal services, podcast production, marketing agency, consulting..."
          autocomplete="off"
        />
        <span class="search-icon">üîç</span>
      </div>
      <div id="searchResults" class="search-results"></div>
      <div id="searchSuggestion" class="search-suggestion"></div>
    </div>
    
    <div class="social-proof">
      <span>‚úÖ No coding required</span>
      <span>üöÄ Deploy in minutes</span>
      <span>üí∞ Start earning autonomously</span>
    </div>
    
    <div class="consent-box">
      <input type="text" id="usernameInput" placeholder="Choose your username" />
      <input type="password" id="passwordInput" placeholder="Create a password" style="display:none;" />
      
      <label>
        <input type="checkbox" id="agreeCheckbox"/> 
        I agree to the <a href="/AiGentsy_Terms_of_Use_v2.pdf" style="color:#00bfff;text-decoration:underline;" target="_blank">protocol terms</a>
      </label>
      
      <div class="toggle-auth">Already have an account? Log in</div>

      <h3 class="section-title">Or Pick a Pre-Built AI Business:</h3>
      
      <div class="aigent-options">
        <div class="aigent-card" data-agent="legal">
          <div class="aigent-card-badge">SELECTED</div>
          <div class="aigent-card-title">‚öñÔ∏è Legal AI</div>
          <div class="aigent-card-desc">Contracts, IP, licensing, compliance ‚Äî automated legal services</div>
        </div>
        
        <div class="aigent-card" data-agent="social">
          <div class="aigent-card-badge">SELECTED</div>
          <div class="aigent-card-title">üì± Social Media AI</div>
          <div class="aigent-card-desc">Content creation, Reels, TikToks, creator monetization</div>
        </div>
        
        <div class="aigent-card" data-agent="saas">
          <div class="aigent-card-badge">SELECTED</div>
          <div class="aigent-card-title">üíª SaaS AI</div>
          <div class="aigent-card-desc">Build & deploy AI-powered software tools and APIs</div>
        </div>
        
        <div class="aigent-card" data-agent="marketing">
          <div class="aigent-card-badge">SELECTED</div>
          <div class="aigent-card-title">üìà Marketing AI</div>
          <div class="aigent-card-desc">SEO, ads, campaigns, growth automation ‚Äî fully autonomous</div>
        </div>
      </div>

      <button id="enterBtn" disabled>üöÄ Launch My AI Business Now</button>
    </div>

    <div class="footer-note">
      Autonomous income. Real-world monetization. No gatekeepers.
    </div>
  </div>
  
  <script>
  (() => {
    if (window.__AIG_HERO_INIT__) return;
    window.__AIG_HERO_INIT__ = true;

    // Config
    const API_BASE = "https://aigentsy-ame-runtime.onrender.com";
    const JSONBIN_URL = window.JSONBIN_URL || null;
    const JSONBIN_SECRET = window.JSONBIN_SECRET || null;

    // Elements
    const usernameInput = document.getElementById('usernameInput');
    const passwordInput = document.getElementById('passwordInput');
    const agreeCheckbox = document.getElementById('agreeCheckbox');
    const enterBtn = document.getElementById('enterBtn');
    const businessSearch = document.getElementById('businessSearch');
    const searchResults = document.getElementById('searchResults');
    const searchSuggestion = document.getElementById('searchSuggestion');

    // State
    let authMode = "signup";
    let selectedAgent = null;
    let customBusinessType = "";

    // Referral
    const params = new URLSearchParams(location.search);
    const referral = params.get("ref") || "origin/hero";
    try { localStorage.setItem("aigentsyReferral", referral); } catch(e){}

    // Whitelabel Business Database
    const whitelabelBusinesses = [
      { id: "legal", name: "Legal Services AI", keywords: ["legal", "lawyer", "attorney", "contract", "ip", "compliance", "law"], desc: "Automate contracts, IP protection, and legal compliance" },
      { id: "social", name: "Social Media AI", keywords: ["social", "content", "creator", "influencer", "tiktok", "instagram", "reels", "video"], desc: "Automated content creation and creator monetization" },
      { id: "saas", name: "SaaS Development AI", keywords: ["saas", "software", "app", "tool", "development", "api", "platform"], desc: "Build and deploy AI-powered software tools" },
      { id: "marketing", name: "Marketing Agency AI", keywords: ["marketing", "seo", "ads", "growth", "agency", "advertising", "campaign"], desc: "Automated SEO, ads, and growth campaigns" },
      { id: "consulting", name: "Consulting Business AI", keywords: ["consulting", "consultant", "advisor", "coaching", "mentor", "strategy"], desc: "Client matching, scheduling, and deliverable automation" },
      { id: "podcast", name: "Podcast Production AI", keywords: ["podcast", "audio", "radio", "show", "broadcasting", "media"], desc: "Automated podcast production and distribution" },
      { id: "ecommerce", name: "E-Commerce AI", keywords: ["ecommerce", "shop", "store", "retail", "selling", "products", "dropship"], desc: "Automated inventory, fulfillment, and customer service" },
      { id: "recruiting", name: "Recruiting Agency AI", keywords: ["recruiting", "hiring", "talent", "hr", "headhunting", "staffing"], desc: "Candidate sourcing, screening, and placement automation" },
      { id: "real-estate", name: "Real Estate AI", keywords: ["real estate", "property", "realtor", "housing", "listings"], desc: "Lead generation, showing scheduling, and deal closing" },
      { id: "finance", name: "Financial Planning AI", keywords: ["finance", "financial", "planning", "investment", "wealth", "accounting"], desc: "Automated financial analysis and planning" },
      { id: "health", name: "Health & Wellness AI", keywords: ["health", "wellness", "fitness", "nutrition", "coaching", "training"], desc: "Client programs, tracking, and engagement automation" },
      { id: "education", name: "Online Education AI", keywords: ["education", "course", "training", "teaching", "learning", "tutoring"], desc: "Course delivery, student engagement, and assessment" }
    ];

    // Helpers
    const companyTypeMap = (agent) => {
      const map = { 
        legal: "legal", social: "social", saas: "saas", marketing: "marketing", 
        consulting: "general", podcast: "general", ecommerce: "general",
        recruiting: "general", "real-estate": "general", finance: "general",
        health: "general", education: "general", custom: "custom" 
      };
      return map[agent] || "general";
    };

    // Search functionality
    function searchBusinesses(query) {
      if (!query || query.length < 2) {
        searchResults.classList.remove('active');
        searchSuggestion.textContent = "";
        return;
      }

      const q = query.toLowerCase();
      const matches = whitelabelBusinesses.filter(biz => 
        biz.name.toLowerCase().includes(q) || 
        biz.keywords.some(kw => kw.includes(q))
      );

      if (matches.length === 0) {
        searchResults.innerHTML = `
          <div class="search-result-item" data-agent="custom">
            <div class="search-result-title">‚ú® Custom Business: "${query}"</div>
            <div class="search-result-desc">We'll build you a custom AI business based on your description</div>
          </div>
        `;
        searchResults.classList.add('active');
        searchSuggestion.textContent = "üí° We'll create a custom AI business for you!";
      } else {
        searchResults.innerHTML = matches.map(biz => `
          <div class="search-result-item" data-agent="${biz.id}">
            <div class="search-result-title">${biz.name}</div>
            <div class="search-result-desc">${biz.desc}</div>
          </div>
        `).join('');
        searchResults.classList.add('active');
        searchSuggestion.textContent = `üí° Found ${matches.length} perfect match${matches.length > 1 ? 'es' : ''} for you!`;
      }

      // Add click handlers
      document.querySelectorAll('.search-result-item').forEach(item => {
        item.addEventListener('click', () => {
          const agent = item.getAttribute('data-agent');
          selectBusiness(agent, item.querySelector('.search-result-title').textContent);
          searchResults.classList.remove('active');
        });
      });
    }

    function selectBusiness(agent, displayName) {
      // Deselect all cards
      document.querySelectorAll('.aigent-card').forEach(c => c.classList.remove('selected'));
      
      // If it's a predefined card, select it
      const matchingCard = document.querySelector(`.aigent-card[data-agent="${agent}"]`);
      if (matchingCard) {
        matchingCard.classList.add('selected');
      }
      
      selectedAgent = agent;
      customBusinessType = agent === "custom" ? businessSearch.value : "";
      
      searchSuggestion.textContent = `‚úÖ Selected: ${displayName}`;
      businessSearch.value = "";
      
      updateButtonState();
    }

    // Close search results when clicking outside
    document.addEventListener('click', (e) => {
      if (!searchResults.contains(e.target) && e.target !== businessSearch) {
        searchResults.classList.remove('active');
      }
    });

    async function registerUserToJSONBin(username, selectedAgent, customDescription, referralCode) {
      if (!JSONBIN_URL || !JSONBIN_SECRET) {
        console.warn("‚ö†Ô∏è JSONBin not configured");
        return;
      }
      
      const now = new Date().toISOString();
      const roleMap = { 
        legal: "CLO", social: "CMO", saas: "CTO", marketing: "CMO", 
        consulting: "CEO", podcast: "CEO", ecommerce: "COO", recruiting: "COO",
        "real-estate": "CEO", finance: "CFO", health: "COO", education: "CEO",
        custom: "CEO", general: "CEO" 
      };
      
      const entry = {
        schemaVersion: 3,
        id: `user_${Date.now()}`,
        username: username,
        consent: { agreed: true, username: username, timestamp: now },
        companyType: companyTypeMap(selectedAgent),
        created: now,
        mintTime: now,
        customInput: customDescription || customBusinessType || "",
        meta_role: roleMap[selectedAgent || "general"],
        role: roleMap[selectedAgent || "general"],
        trait: selectedAgent || "founder",
        traits: [selectedAgent || "general", "founder", "autonomous", "aigentsy"],
        runtimeFlags: { vaultAccess: true, remixUnlocked: false, cloneLicenseUnlocked: false, sdkAccess_eligible: selectedAgent === "saas" },
        wallet: { address: "0x0", staked: 0 },
        staked: 0,
        yield: { autoStake: false, aigxEarned: 0, vaultYield: 0, remixYield: 0, aigxAttributedTo: [], aigxEarnedEnabled: false },
        remixUnlocked: false,
        remixUnlockedForks: 0,
        remix: { remixCount: 0, remixCredits: 1000, lineageDepth: 0, royaltyTerms: "Standard 30%" },
        cloneLineage: [],
        cloneLicenseUnlocked: false,
        proposals: [], orders: [], invoices: [], payments: [], contacts: [], meetings: [], kpi_snapshots: [], docs: [],
        ownership: { ledger: [] },
        kits: {
          universal: { unlocked: true },
          growth: { unlocked: false },
          legal: { unlocked: selectedAgent === "legal" },
          sdk: { unlocked: false },
          branding: { unlocked: false },
          marketing: { unlocked: selectedAgent === "marketing" },
          social: { unlocked: selectedAgent === "social" }
        },
        metaloop: { enabled: true, lastMatchCheck: null, proposalHistory: [] },
        metabridge: { active: true, lastBridge: null, bridgeCount: 0 },
        automatch: { status: "pending", lastMatchResult: null, matchReady: true },
        referral: referralCode || "origin/hero",
        runtimeURL: "https://aigentsy.com/agents/aigent0.html",
        protocol: "MetaUpgrade25+26",
        realm: { name: "Realm 101 ‚Äî Strategic Expansion", joinedAt: now },
        metaVenture: { ventureHive: "Autonomous Launch", ventureRole: roleMap[selectedAgent || "general"], ventureStatus: "Pending", ventureID: `MV-${Date.now()}` },
        mirror: { mirroredInRealms: ["Realm 101 ‚Äî Strategic Expansion"], mirrorIntegrity: "Verified", sentinelAlert: false },
        earningsEnabled: true,
        listingStatus: "active",
        protocolStatus: "Bound",
        tethered: true,
        sdkAccess_eligible: selectedAgent === "saas",
        sdkAccess: false,
        vaultAccess: true,
        licenses: { sdk: false, vault: false, remix: false, clone: false, aigx: false },
        transactions: { unlocks: [], yieldEvents: [], referralEvents: [] },
        packaging: { kits_sent: [], proposals: [], custom_files: [], active: false },
        offerings: { products: [], services: [], pricing: [], description: "" }
      };
      
      try {
        console.log("üì° Fetching JSONBin...");
        const getRes = await fetch(JSONBIN_URL, { headers: { "X-Master-Key": JSONBIN_SECRET } });
        if (!getRes.ok) throw new Error(`GET failed: ${getRes.status}`);
        
        const currentData = await getRes.json();
        let currentArray = Array.isArray(currentData.record) ? currentData.record : (Array.isArray(currentData) ? currentData : []);
        
        console.log(`üìù Current users: ${currentArray.length}`);
        
        const existingIndex = currentArray.findIndex(u => u.username === username || u.consent?.username === username);
        if (existingIndex >= 0) {
          console.log("‚ö†Ô∏è Updating existing user");
          currentArray[existingIndex] = entry;
        } else {
          console.log("‚úÖ Adding new user");
          currentArray.push(entry);
        }
        
        console.log(`üíæ Saving ${currentArray.length} users...`);
        const putRes = await fetch(JSONBIN_URL, {
          method: "PUT",
          headers: { "Content-Type": "application/json", "X-Master-Key": JSONBIN_SECRET },
          body: JSON.stringify(currentArray)
        });
        
        if (!putRes.ok) throw new Error(`PUT failed: ${putRes.status}`);
        console.log("‚úÖ Registered successfully!");
        
      } catch (err) {
        console.error("‚ùå JSONBin error:", err);
        throw err;
      }
    }

    // UI
    function updateButtonState() {
      const valid = usernameInput.value.trim().length > 0 && agreeCheckbox.checked && !!selectedAgent;
      enterBtn.disabled = !valid;
    }

    window.toggleAuthMode = function() {
      authMode = (authMode === "login") ? "signup" : "login";
      const el = document.querySelector('.toggle-auth');
      const pwdField = document.getElementById('passwordInput');
      
      if (authMode === "login") {
        el.textContent = "Don't have an account? Sign up";
        pwdField.style.display = "block";
        enterBtn.textContent = "üîê Log In";
      } else {
        el.textContent = "Already have an account? Log in";
        pwdField.style.display = "none";
        enterBtn.textContent = "üöÄ Launch My AI Business Now";
      }
    };

    // Events
    businessSearch.addEventListener('input', (e) => searchBusinesses(e.target.value));
    businessSearch.addEventListener('focus', (e) => {
      if (e.target.value.length >= 2) searchBusinesses(e.target.value);
    });

    document.querySelectorAll('.aigent-card').forEach(card => {
      card.addEventListener('click', () => {
        document.querySelectorAll('.aigent-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        selectedAgent = card.getAttribute('data-agent');
        customBusinessType = "";
        searchSuggestion.textContent = `‚úÖ Selected: ${card.querySelector('.aigent-card-title').textContent}`;
        updateButtonState();
      });
    });

    document.querySelector('.toggle-auth').addEventListener('click', window.toggleAuthMode);
    usernameInput.addEventListener('input', updateButtonState);
    agreeCheckbox.addEventListener('change', updateButtonState);

    enterBtn.addEventListener('click', async () => {
      if (enterBtn.disabled) return;
      const username = usernameInput.value.trim();
      if (!username) { alert("Please enter a username"); return; }
      
      try { localStorage.setItem("aigentsyUsername", username); } catch(e){}
      try { localStorage.setItem("aigentsyUserAgent", selectedAgent); } catch(e){}

      enterBtn.disabled = true;
      enterBtn.innerHTML = "üöÄ Building your AI business...";
      
      try {
        console.log("üìù Registering:", username, "as", selectedAgent);
        await registerUserToJSONBin(username, selectedAgent, customBusinessType, referral);
        console.log("üöÄ Redirecting...");
        window.location.assign(`/agents/aigent0.html?user=${encodeURIComponent(username)}`);
      } catch (e) {
        console.error("‚ùå Error:", e);
        alert("Could not create your AiGentsy. Please try again.");
        enterBtn.disabled = false;
        enterBtn.innerHTML = "üöÄ Launch My AI Business Now";
      }
    });

    updateButtonState();
  })();
  </script>
</body>
</html>
